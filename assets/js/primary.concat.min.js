/**
 * Wed, 11 Jan 2012 08:01:12 GMT
 * Files included (remove the .min to see original source file if available): 
 *
 * http://www.jainaewen.com/library/javascript/ef/jquery/link-manager/jquery.link-manager.min.js
 * http://www.jainaewen.com/library/javascript/ef/primary.js
 * http://www.jainaewen.com/library/javascript/ef/facebook.js
 * http://www.jainaewen.com/library/javascript/ef/google.js
 * http://www.jainaewen.com/library/javascript/ef/twitter.js
 */
/**
 * Copyright (c) 2010 - 2011 Ewen Elder Licensed under the MIT and GPL licenses: http://www.opensource.org/licenses/mit-license.php http://www.gnu.org/licenses/gpl.html
 * @author: Ewen Elder <glomainn at yahoo dot co dot uk> <ewen at jainaewen dot com>
 * @version:1.0.1 (2011-07-18)
 */
(function(e){e.fn.linkManager=function(b){var g,h,a,d,c,f,i,b=e.extend({},e.linkManager.defaults,b);return e(this).each(function(){e(this).find(b.selector).each(function(){h=e(this);a=h.attr("href").replace("http://","");d=a.indexOf("/")>-1?a.substr(0,a.indexOf("/")):a;d=d.indexOf("?")>-1?d.substr(0,a.indexOf("?")):d;d=d.indexOf("#")>-1?d.substr(0,a.indexOf("#")):d;c=a.indexOf("/")>-1?a.substr(a.indexOf("/"),a.length):"";c=c.indexOf("?")>-1?c.substr(0,c.indexOf("?")):c;c=c.indexOf("#")>-1?c.substr(0, c.indexOf("#")):c;f=a.indexOf("?")>-1?a.substr(a.indexOf("?")+1):"";f=f.indexOf("#")>-1?f.substr(0,f.indexOf("#")):f;i=a.indexOf("#")>-1?a.substr(a.indexOf("#")+1):"";g=d!==window.location.hostname?!0:!1;e(b.include).each(function(){if(!g&&(b.usePathname&&c.indexOf(this)>-1||b.useQuerystring&&f.indexOf(this)>-1||b.useHash&&i.indexOf(this)>-1))g=!0});e(b.exclude).each(function(){if(b.useDomain&&d.indexOf(this)>-1||b.usePathname&&c.indexOf(this)>-1||b.useQuerystring&&f.indexOf(this)>-1||b.useHash&& i.indexOf(this)>-1)g=!1});d.length&&g&&h.attr("target",b.target)})})};e.linkManager={version:1.1,defaults:{selector:"a:not([href=#])",target:"_blank",include:[],exclude:[],useDomain:!0,usePathname:!0,useQuerystring:!0,useHash:!1}}})(jQuery);
var ewensFiles = 
{
	init : function ()
	{
		$('ul.navigation.primary li:nth-child(6), ul.navigation.primary li:nth-child(7)').click(function ()
		{
			alert('This area has not been completed yet.');
			return false;
		});
		
		
		
		$('ul.navigation.secondary').insertAfter('#content');
		
		
		$(document.createElement('div'))
			.attr('id', 'social-bookmarks')
			.insertAfter('#content');
		
		
		this.inheritance()
			.ie()
			.plugins()
			.twitter.init().parent
			.google.init().parent
			.facebook.init().parent;
	},
	
	
	/**
	 * Setup and Initialise jQuery plugins here.
	 */
	plugins : function ()
	{
		$('body').linkManager();
		return this;
	},
	
	
	/**
	 * IE.
	 */
	ie : function ()
	{
		this.ie = typeof ActiveXObject !== 'undefined' ? true : false;
		
		
		if (this.ie)
		{
			// IE 6.
			if (typeof XMLHttpRequest === 'undefined')
			{
				this.ieVersion = 6;
			}
			
			// IE 7.
			else if (typeof document.documentMode === 'undefined')
			{
				this.ieVersion = 7;
			}
			
			// Use documentMode.
			else
			{
				this.ieVersion = document.documentMode;
			}
		}
		
		
		return this;
	},
	
	
	/**
	 * Really simple class inheritance,
	 * This method sends an object's child item to hasClass and if returned true then adds a reference of object to it's child item.
	 * 
	 * @param {Object} object The class to add inheritence
	 * @return {Object} ewensFiles
	 */
	inheritance : function (object)
	{
		var item;
		
		object = !object ? this : object;
		
		for (item in object)
		{
			if (item !== 'parent' && item !== 'firstParent' && this.hasClass(object[item]))
			{
				object[item].parent = object;
				object[item].firstParent = this;
				
				this.inheritance(object[item]);
			}
		}
		
		
		return this;
	},
	
	
	/**
	 * Test if a class/object has any classes.
	 * 
	 * @param {Object} object The class/object to test
	 * @param {Array} ignore Array of object names to ignore/skip
	 * @return {Bool}
	 */
	hasClass : function (object, ignore)
	{
		var item;
		
		
		for (item in object)
		{
			if (typeof ignore !== 'undefined' && $.inArray(item, ignore) > -1)
			{
				continue;
			}
			
			
			if (typeof object[item] === 'function')
			{
				return true;
			}
			
			else if (typeof object[item] === 'object')
			{
				return this.hasClass(object[item]);
			}
		}
		
		
		return false;
	}
}


window.onload = function ()
{
	ewensFiles.init();
}
ewensFiles.facebook = {
	/**
	 * @var {String} Where to insert stuff.
	 */
	insertBeforeElement : '.navigation.info',
	
	
	/**
	 * @var {Object} The native location object, references here for when I get around to optimising and minifying this file.
	 */
	currentLocation : window.location,
	
	
	/**
	 * Initiate this class.
	 * 
	 * @return {Object} ewensFiles.facebook
	 */
	init : function ()
	{
		this
			.setup()
			.activity()
			.recommendations()
			.comments()
			.likes()
			.setup(true);
		
		
		return this;
	},
	
	
	/**
	 * Set up required stuff.
	 * 
	 * @return {Object} ewensFiles.facebook
	 */
	setup : function (ready)
	{
		if (!ready)
		{
			// FB Javascript.
			$(document.createElement('script'))
				.attr({
					src : this.currentLocation.protocol + '//connect.facebook.net/en_US/all.js#xfbml=1',
					async : true
				}).appendTo('body');
			
			// FB Root element.
			$(document.createElement('div'))
				.insertBefore(this.insertBeforeElement)
				.attr('id', 'fb-root');
		}
		
		else
		{
			window.fbAsyncInit = function()
			{
				FB.init({
					appId : '142282242450816',
					status : true,
					cookie : true,
					xfbml : true
				});
			};
		}
		
		
		return this;
	},
	
	
	/**
	 * Activity plugin.
	 * 
	 * @return {Object} ewensFiles.facebook
	 */
	activity : function ()
	{
		// Activity.
		$(document.createElement('h2'))
			.insertBefore(this.insertBeforeElement)
			.attr('id', 'facebook-recent-activity')
			.text('Recent Activity');
		
		$(document.createElement('fb:activity'))
			.insertBefore(this.insertBeforeElement)
			.addClass('facebook activity')
			.attr({
				site : 'http://www.jainaewen.com',
				width : 300,
				height : 300,
				header : false,
				colorscheme : 'dark',
				font : 'lucida grande',
				borderColor : '#000',
				recommendations : true
			});
		
		
		return this;
	},
	
	
	/**
	 * Recommendations plugin.
	 * 
	 * @return {Object} ewensFiles.facebook
	 */
	recommendations : function ()
	{
		$(document.createElement('h2'))
			.insertBefore(this.insertBeforeElement)
			.attr('id', 'facebook-recommendations')
			.text('Recommendations');
		
		$(document.createElement('fb:recommendations'))
			.insertBefore(this.insertBeforeElement)
			.addClass('facebook recommendations')
			.attr({
				site : 'http://www.jainaewen.com',
				width : 300,
				height : 300,
				header : false,
				colorscheme : 'dark',
				font : 'lucida grande',
				borderColor : '#000'
			});
		
		
		return this;
	},
	
	
	/**
	 * Comments plugin.
	 * 
	 * @return {Object} ewensFiles.facebook
	 */
	comments : function ()
	{
		$(document.createElement('h2'))
			.insertBefore(this.insertBeforeElement)
			.attr('id', 'facebook-comments')
			.text('Comments');
		
		$(document.createElement('fb:comments'))
			.insertBefore(this.insertBeforeElement)
			.addClass('facebook comments')
			.attr({
				colorscheme : 'dark',
				numposts : 5,
				width : 500,
				borderColor : '#000',
				migrated : true,
				xid : this.currentLocation.host + this.currentLocation.pathname.replace(/\//g, '%2F').replace(/\.html/, '%2Findex.php')
			});
		
		
		return this;
	},
	
	
	/**
	 * Likes button plugin.
	 * 
	 * @return {Object} ewensFiles.facebook
	 */
	likes : function ()
	{
		var attributes = {
			href : this.currentLocation.protocol + '//' + this.currentLocation.hostname + this.currentLocation.pathname,
			send : false,
			layout : 'box_count',
			showFaces : true,
			font : 'lucida grande'
		};
		
		
		$(document.createElement('div'))
			.addClass('facebook like')
			.prependTo('#social-bookmarks');
		
		
		$(document.createElement('fb:like'))
			.addClass('facebook like')
			.attr(attributes)
			.appendTo('#social-bookmarks > .facebook.like');
		
		
		return this;
	}
};
ewensFiles.google =
{
	/**
	 * Initiate this class.
	 * 
	 * @return {Object} ewensFiles.google
	 */
	init : function ()
	{
		var self = this;
		
		
			self.adsense();
		
		
		return this.plusOne();
	},
	
	
	/**
	 * +1 button.
	 * 
	 * @return {Object} ewensFiles.google
	 */
	plusOne : function ()
	{
		window.lang = 'en-BG';
		window.parseTags = 'explicit';
		
		$.getScript('https://apis.google.com/js/plusone.js');
		
		
		$(document.createElement('div'))
			.addClass('google plus1')
			.prependTo('#social-bookmarks');
		
		$(document.createElement('g:plusone'))
			.attr({
				size : 'tall',
				href : window.location.protocol + '//' + window.location.hostname + window.location.pathname
			})
			.appendTo('.google.plus1');
		
		
		return this;
	},
	
	
	/**
	 * Adsense adverts,
	 * This doesn't work because google use .write; I thought of loading show_ads.js file as text, replacing the .writes and then eval() it, but that's prbly against google's guidelines :( .
	 * 
	 * @return {Object} ewensFiles.google
	 */
	adsense : function ()
	{
		/*
		window.google_ad_client = 'ca-pub-9284739190722190',
		window.google_ad_slot = '9637344467',
		window.google_ad_width = 234,
		window.google_ad_height = 60;
		
		
		$(document.createElement('script'))
			.attr({
				type : 'text/javascript',
				src : 'http://pagead2.googlesyndication.com/pagead/show_ads.js'
			}).insertAfter('body > .site.info');
		*/
		
		
		return this;
	}
};
ewensFiles.twitter = {
	init : function ()
	{
		$(document.createElement('div'))
			.addClass('twitter tweet')
			.prependTo('#social-bookmarks');
		
		$(document.createElement('a'))
			.addClass('twitter-share-button')
			.attr({
				href : 'http://twitter.com/share',
				'data-count' : 'vertical'
			}).appendTo('#social-bookmarks .twitter.tweet');
		
		
		$.getScript('http://platform.twitter.com/widgets.js');
		
		
		return this;
	}
};